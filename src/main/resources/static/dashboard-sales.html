<!-- html -->
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Manager - Orders</title>
    <style>
        * { box-sizing: border-box; margin:0; padding:0; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:#f5f5f5; }
        .navbar { background: linear-gradient(135deg,#28a745,#218838); color:#fff; padding:20px; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
        .navbar-content { max-width:1200px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; }
        .logout-btn { background:#fff;color:#28a745;border:none;padding:8px 14px;border-radius:6px;cursor:pointer;font-weight:600; }
        .modal { position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.4); z-index:50; }
        .modal.show { display:flex; }
        .modal-content { width:90%; max-width:800px; background:#fff; border-radius:8px; padding:20px; box-shadow:0 8px 30px rgba(0,0,0,0.2); max-height:80vh; overflow:auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .spinner { border:4px solid #f3f3f3; border-top:4px solid #3498db; border-radius:50%; width:40px; height:40px; margin:0 auto; animation:spin 1s linear infinite; }
        .container { max-width:1200px;margin:24px auto;padding:20px; }
        .search-bar { display:flex; gap:10px; align-items:center; margin-bottom:12px; flex-wrap:wrap; }
        .search-bar input[type="text"], .search-bar select, .search-bar input[type="date"] { padding:8px 10px; border-radius:6px; border:1px solid #ddd; }
        .search-bar .btn { padding:8px 12px; border-radius:6px; border:none; cursor:pointer; }
        .btn-find { background:#218838; color:#fff; }
        .btn-reset { background:#e9ecef; color:#333; }
        table { width:100%; border-collapse:collapse; background:#fff; border-radius:8px; overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,0.06); }
        th, td { padding:12px 14px; text-align:left; border-bottom:1px solid #eee; }
        th { background:#fafafa; color:#333; font-weight:700; }
        tr:hover td { background:#fcfffc; }
        .btn-view { background:#218838; color:#fff; border:none; padding:6px 10px; border-radius:6px; cursor:pointer; }
        .modal { position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.4); z-index:50; }
        .modal.show { display:flex; }
        .modal-content { width:90%; max-width:800px; background:#fff; border-radius:8px; padding:20px; box-shadow:0 8px 30px rgba(0,0,0,0.2); max-height:80vh; overflow:auto; }
        .modal-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
        .close-btn { background:#e9ecef; border:none; padding:6px 10px; border-radius:6px; cursor:pointer; }
        .small { font-size:0.9rem; color:#666; }
        .modal-content { max-height:85vh; }
        .modal-content > div:nth-child(2) { max-height:calc(85vh - 100px); overflow-y:auto; }
    </style>
</head>
<body>
<nav class="navbar">
    <div class="navbar-content">
        <div><h2>üíº Sales Manager - Orders</h2></div>
        <div style="display:flex; gap:12px; align-items:center;">
            <div id="userDisplay">Loading...</div>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>
    </div>
</nav>

<div class="container">
    <h3 style="margin-bottom:12px;">Order List</h3>

    <div class="search-bar" role="search" aria-label="Order search">
        <input id="qInput" type="text" placeholder="Order ID or Customer" aria-label="Order ID or Customer" style="min-width:220px;">
        <select id="statusSelect" aria-label="Status">
            <option>All</option>
            <option>Pending</option>
            <option>Shipped</option>
            <option>Completed</option>
            <option>Cancelled</option>
        </select>
        <input id="dateInput" type="date" aria-label="Order date">
        <button id="findBtn" class="btn btn-find" onclick="findOrders()">Find</button>
        <button id="resetBtn" class="btn btn-reset" onclick="resetSearch()">Reset</button>
        <button id="addOrderBtn" class="btn btn-find" style="background:#0069d9;" onclick="openAddModal()">Th√™m m·ªõi</button>
        <button id="syncBtn" class="btn btn-find" style="background:#6f42c1;" onclick="syncMongoData()">ƒê·ªìng b·ªô MongoDB</button>
        <button id="viewMongoBtn" class="btn btn-find" style="background:#fd7e14;" onclick="viewMongoData()">Xem d·ªØ li·ªáu MongoDB</button>
    </div>

    <!-- MongoDB Data Modal -->
    <div id="mongoModal" class="modal">
        <div class="modal-content" style="width:95%; max-width:1200px;">
            <div class="modal-header">
                <h3>D·ªØ li·ªáu MongoDB</h3>
                <button onclick="closeMongoModal()" class="close-btn">&times;</button>
            </div>
            <div style="margin:15px 0; overflow:auto;">
                <table style="width:100%; border-collapse:collapse;">
                    <thead>
                        <tr id="mongoTableHead"></tr>
                    </thead>
                    <tbody id="mongoTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Sync Progress Modal -->
    <div id="syncModal" class="modal">
        <div class="modal-content" style="max-width:400px;">
            <div class="modal-header">
                <h3>ƒê·ªìng b·ªô d·ªØ li·ªáu</h3>
            </div>
            <div id="syncStatus" style="padding:20px;text-align:center;">
                <div style="margin-bottom:15px;">ƒêang ƒë·ªìng b·ªô d·ªØ li·ªáu t·ª´ MongoDB...</div>
                <div class="spinner" style="border:4px solid #f3f3f3;border-top:4px solid #3498db;border-radius:50%;width:40px;height:40px;margin:0 auto;animation:spin 1s linear infinite;"></div>
            </div>
        </div>
    </div>

    <style>
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    </style>

    <table id="ordersTable" aria-live="polite">
        <thead>
        <tr>
            <th>Order ID</th>
            <th>Customer</th>
            <th>Order Date</th>
            <th>Total</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
        </thead>
        <tbody>
        <!-- rows populated by JS -->
        </tbody>
    </table>
</div>

<div id="orderModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Order Detail</h3>
            <button class="close-btn" onclick="closeModal()">Close</button>
        </div>
        <div id="orderDetail"></div>
    </div>
</div>

<!-- Add Order Modal -->
<div id="addOrderModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Th√™m Order m·ªõi</h3>
            <button class="close-btn" onclick="closeAddModal()">Close</button>
        </div>
        <div>
            <div style="display:flex; gap:8px; margin-bottom:8px; flex-wrap:wrap;">
                <input id="addCustomer" type="text" placeholder="Customer name" style="flex:1; padding:8px;" />
                <input id="addDate" type="date" style="padding:8px;" />
                <select id="addStatus" style="padding:8px;"><option>Pending</option><option>Shipped</option><option>Completed</option><option>Cancelled</option></select>
            </div>

            <table style="width:100%; border-collapse:collapse; margin-bottom:8px;">
                <thead><tr style="background:#fafafa;"><th style="padding:6px;">#</th><th style="padding:6px;">Description</th><th style="padding:6px;">Qty</th><th style="padding:6px;">Unit Price</th><th style="padding:6px;">Line</th><th style="padding:6px;"></th></tr></thead>
                <tbody id="addItemsBody"></tbody>
            </table>
            <div style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
                <div>
                    <button class="btn btn-find" onclick="addItemRow()">Th√™m d√≤ng</button>
                </div>
                <div style="text-align:right;">
                    <div style="margin-bottom:6px;"><strong>Total:</strong> <span id="addTotal">$0.00</span></div>
                    <div style="display:flex; gap:8px; justify-content:flex-end;">
                        <button class="btn btn-reset" onclick="closeAddModal()">H·ªßy</button>
                        <button class="btn btn-find" onclick="saveNewOrder()">L∆∞u</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

    <script>
        const username = localStorage.getItem('username');
        const role = localStorage.getItem('role');
        const token = localStorage.getItem('token');

        let mongoPage = 0;
        let mongoLimit = 50;
        let mongoTotal = 0;
        let mongoLoaded = [];
        let mongoKeys = [];
        let mongoLoading = false;

        async function viewMongoData() {
            mongoPage = 0;
            mongoLoaded = [];
            mongoKeys = [];
            mongoLoading = false;
            const mongoModal = document.getElementById('mongoModal');
            const tableHead = document.getElementById('mongoTableHead');
            const tableBody = document.getElementById('mongoTableBody');
            mongoModal.style.display = 'block';
            tableHead.innerHTML = '';
            tableBody.innerHTML = '<tr><td colspan="10" style="text-align:center; padding:20px;">ƒêang t·∫£i d·ªØ li·ªáu...</td></tr>';
            await loadMongoPage(0, true);
        }

        async function loadMongoPage(page, initial = false) {
            if (mongoLoading) return;
            mongoLoading = true;
            try {
                const response = await fetch(`/api/mongo/transactions?page=${page}&limit=${mongoLimit}`, {
                    headers: { 'Authorization': 'Bearer ' + token }
                });
                if (!response.ok) throw new Error('Failed to fetch MongoDB data');
                const result = await response.json();
                const data = result.data || [];
                mongoTotal = result.total || 0;
                if (initial) {
                    // Get all unique keys from first page
                    const allKeys = new Set();
                    data.forEach(doc => Object.keys(doc).forEach(k => allKeys.add(k)));
                    mongoKeys = Array.from(allKeys);
                    const tableHead = document.getElementById('mongoTableHead');
                    tableHead.innerHTML = mongoKeys.map(k => `<th>${k}</th>`).join('');
                }
                mongoLoaded = mongoLoaded.concat(data);
                renderMongoTable();
                // If there are more pages, auto-load next page in background
                if ((page + 1) * mongoLimit < mongoTotal) {
                    setTimeout(() => loadMongoPage(page + 1, false), 200); // slight delay for UI
                }
            } catch (error) {
                const tableBody = document.getElementById('mongoTableBody');
                tableBody.innerHTML = `<tr><td colspan='10' style='color:red;'>L·ªói: ${escapeHtml(error.message)}</td></tr>`;
            } finally {
                mongoLoading = false;
            }
        }

        function renderMongoTable() {
            const tableBody = document.getElementById('mongoTableBody');
            if (mongoLoaded.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="10">Kh√¥ng c√≥ d·ªØ li·ªáu</td></tr>';
                return;
            }
            // Only show current page
            const start = mongoPage * mongoLimit;
            const end = Math.min(start + mongoLimit, mongoLoaded.length);
            const pageData = mongoLoaded.slice(start, end);
            tableBody.innerHTML = pageData.map(doc => {
                return `<tr>` + mongoKeys.map(k => `<td>${doc[k] !== undefined ? escapeHtml(doc[k]) : ''}</td>`).join('') + `</tr>`;
            }).join('');
            renderMongoPagination();
        }

        function renderMongoPagination() {
            const tableBody = document.getElementById('mongoTableBody');
            let pagin = document.getElementById('mongoPagination');
            if (!pagin) {
                pagin = document.createElement('tr');
                pagin.id = 'mongoPagination';
                tableBody.parentElement.appendChild(pagin);
            }
            const totalPages = Math.ceil(mongoTotal / mongoLimit);
            pagin.innerHTML = `<td colspan='${mongoKeys.length}' style='text-align:center;'>
                <button onclick='mongoPrevPage()' ${mongoPage === 0 ? 'disabled' : ''}>Trang tr∆∞·ªõc</button>
                Trang ${mongoPage + 1} / ${totalPages}
                <button onclick='mongoNextPage()' ${((mongoPage + 1) * mongoLimit >= mongoLoaded.length) ? 'disabled' : ''}>Trang sau</button>
                <span style='margin-left:20px;'>ƒê√£ t·∫£i ${mongoLoaded.length}/${mongoTotal} b·∫£n ghi</span>
            </td>`;
        }

        window.mongoPrevPage = function() {
            if (mongoPage > 0) {
                mongoPage--;
                renderMongoTable();
            }
        }
        window.mongoNextPage = function() {
            if ((mongoPage + 1) * mongoLimit < mongoLoaded.length) {
                mongoPage++;
                renderMongoTable();
            }
        }
        function closeMongoModal() {
            document.getElementById('mongoModal').style.display = 'none';
        }

        async function syncMongoData() {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën ƒë·ªìng b·ªô d·ªØ li·ªáu t·ª´ MongoDB?')) {
                return;
            }

            const syncModal = document.getElementById('syncModal');
            syncModal.style.display = 'block';

            try {
                const response = await fetch('/api/data/sync', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + token
                    }
                });

                if (!response.ok) {
                    throw new Error('ƒê·ªìng b·ªô th·∫•t b·∫°i');
                }

                alert('ƒê·ªìng b·ªô d·ªØ li·ªáu th√†nh c√¥ng!');
                // Reload the orders list to show new data
                findOrders();
            } catch (error) {
                alert('L·ªói khi ƒë·ªìng b·ªô: ' + error.message);
            } finally {
                syncModal.style.display = 'none';
            }
        }    if (!token || !username) {
        window.location.href = '/login.html';
    } else if (role !== 'Sales Manager') {
        alert('Access Denied: Sales Manager only!');
        window.location.href = '/login.html';
    } else {
        document.getElementById('userDisplay').textContent = `üë§ ${username}`;
    }


    // Pagination state
    let orderPage = 0;
    let orderLimit = 50;
    let orderTotal = 0;
    let orderList = [];

    async function fetchOrders(page = 0) {
        orderPage = page;
        const res = await fetch(`/api/orders/paged?page=${orderPage}&limit=${orderLimit}`, {
            headers: { 'Authorization': 'Bearer ' + token }
        });
        if (!res.ok) {
            console.error('Failed to fetch orders', res.status);
            return;
        }
        const result = await res.json();
        orderList = result.data || [];
        orderTotal = result.total || 0;
        renderOrderList(orderList);
        renderOrderPagination();
    }

    async function findOrders() {
        const q = document.getElementById('qInput').value.trim();
        const status = document.getElementById('statusSelect').value;
        const date = document.getElementById('dateInput').value;

        const params = new URLSearchParams();
        if (q) params.append('q', q);
        if (status && status !== 'All') params.append('status', status);
        if (date) params.append('orderDate', date);

        const url = '/api/orders' + (params.toString() ? ('?' + params.toString()) : '');
        const res = await fetch(url, { headers: { 'Authorization': 'Bearer ' + token } });
        if (!res.ok) {
            console.error('Failed to fetch filtered orders', res.status);
            return;
        }
        const list = await res.json();
        renderOrderList(list);
    }

    function resetSearch() {
        document.getElementById('qInput').value = '';
        document.getElementById('statusSelect').value = 'All';
        document.getElementById('dateInput').value = '';
        fetchOrders();
    }

    function renderOrderList(list) {
        const tbody = document.querySelector('#ordersTable tbody');
        tbody.innerHTML = '';
        if (!list.length) {
            tbody.innerHTML = '<tr><td colspan="6">Kh√¥ng c√≥ d·ªØ li·ªáu</td></tr>';
            return;
        }
        list.forEach(o => {
            const tr = document.createElement('tr');
            const tdId = document.createElement('td');
            const link = document.createElement('a');
            link.href = '#';
            link.textContent = o.orderId;
            link.addEventListener('click', (e) => { e.preventDefault(); openDetail(o.orderId); });
            tdId.appendChild(link);
            const tdCustomer = document.createElement('td');
            const custLink = document.createElement('a');
            custLink.href = '#';
            // Show customerId if available, otherwise show customerName (if any), else '-'
            custLink.textContent = o.customerIdRaw ? o.customerIdRaw : (o.customerName ? o.customerName : '-');
            custLink.addEventListener('click', (e) => { e.preventDefault(); openDetail(o.orderId); });
            tdCustomer.appendChild(custLink);
            const tdDate = document.createElement('td');
            tdDate.textContent = o.orderDate ? new Date(o.orderDate).toLocaleDateString() : '-';
            const tdTotal = document.createElement('td');
            tdTotal.textContent = o.totalAmount != null ? `$${Number(o.totalAmount).toFixed(2)}` : '-';
            const tdStatus = document.createElement('td');
            tdStatus.textContent = o.status || '-';
            const tdAction = document.createElement('td');
            const btn = document.createElement('button');
            btn.className = 'btn-view';
            btn.textContent = 'View';
            btn.addEventListener('click', () => openDetail(o.orderId));
            tdAction.appendChild(btn);
            tr.appendChild(tdId);
            tr.appendChild(tdCustomer);
            tr.appendChild(tdDate);
            tr.appendChild(tdTotal);
            tr.appendChild(tdStatus);
            tr.appendChild(tdAction);
            tbody.appendChild(tr);
        });
    }

    function renderOrderPagination() {
        const tbody = document.querySelector('#ordersTable tbody');
        let pagin = document.getElementById('orderPagination');
        if (!pagin) {
            pagin = document.createElement('tr');
            pagin.id = 'orderPagination';
            tbody.parentElement.appendChild(pagin);
        }
        const totalPages = Math.ceil(orderTotal / orderLimit);
        pagin.innerHTML = `<td colspan='6' style='text-align:center;'>
            <button onclick='orderPrevPage()' ${orderPage === 0 ? 'disabled' : ''}>Trang tr∆∞·ªõc</button>
            Trang ${orderPage + 1} / ${totalPages}
            <button onclick='orderNextPage()' ${(orderPage + 1 >= totalPages) ? 'disabled' : ''}>Trang sau</button>
            <span style='margin-left:20px;'>T·ªïng ${orderTotal} b·∫£n ghi</span>
        </td>`;
    }

    window.orderPrevPage = function() {
        if (orderPage > 0) {
            fetchOrders(orderPage - 1);
        }
    }
    window.orderNextPage = function() {
        const totalPages = Math.ceil(orderTotal / orderLimit);
        if (orderPage + 1 < totalPages) {
            fetchOrders(orderPage + 1);
        }
    }

    async function openDetail(orderId) {
        const res = await fetch('/api/orders/' + encodeURIComponent(orderId), {
            headers: { 'Authorization': 'Bearer ' + token }
        });
        if (!res.ok) {
            alert('Order not found');
            return;
        }
        const d = await res.json();
        showModal(d);
    }

    function showModal(d) {
        const container = document.getElementById('orderDetail');
        container.innerHTML = `
                <div style="margin-bottom:10px;"><strong>Order ID:</strong> ${escapeHtml(d.orderId || '')}</div>
                <div style="margin-bottom:10px;"><strong>Customer:</strong> ${escapeHtml(d.customerName || '')}</div>
                <div style="margin-bottom:10px;"><strong>Order Date:</strong> ${d.orderDate ? new Date(d.orderDate).toLocaleDateString() : '-'}</div>
                <div style="margin-bottom:10px;"><strong>Total:</strong> ${d.totalAmount != null ? '$' + Number(d.totalAmount).toFixed(2) : '-'}</div>
                <div style="margin-bottom:14px;"><strong>Status:</strong> ${escapeHtml(d.status || '')}</div>
                <h4 class="small">Order Items</h4>
                <table style="width:100%; border-collapse:collapse; margin-top:8px;">
                    <thead><tr style="background:#fafafa;"><th>Item</th><th>Product</th><th>Qty</th><th>Unit</th><th>Line Total</th></tr></thead>
                    <tbody>
                        ${d.items && d.items.length ? d.items.map(it => `
                            <tr>
                                <td>${escapeHtml(String(it.itemId || ''))}</td>
                                <td>${escapeHtml(it.description || it.productId || '')}</td>
                                <td>${escapeHtml(String(it.quantity || 0))}</td>
                                <td>${it.unitPrice != null ? '$' + Number(it.unitPrice).toFixed(2) : '-'}</td>
                                <td>${it.lineTotal != null ? '$' + Number(it.lineTotal).toFixed(2) : '-'}</td>
                            </tr>
                        `).join('') : `<tr><td colspan="5">No items</td></tr>`}
                    </tbody>
                </table>
            `;
        document.getElementById('orderModal').classList.add('show');
    }

    function closeModal() {
        document.getElementById('orderModal').classList.remove('show');
    }

    function logout() {
        localStorage.clear();
        window.location.href = '/login.html';
    }

    function escapeHtml(str) {
        return String(str)
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#039;');
    }

    // load on start
    fetchOrders(0);

    // Add Order modal JS
    function openAddModal() {
        document.getElementById('addCustomer').value = '';
        document.getElementById('addDate').value = '';
        document.getElementById('addStatus').value = 'Pending';
        const body = document.getElementById('addItemsBody');
        body.innerHTML = '';
        addItemRow();
        computeAddTotal();
        document.getElementById('addOrderModal').classList.add('show');
    }

    function closeAddModal() {
        document.getElementById('addOrderModal').classList.remove('show');
    }

    function addItemRow() {
        const tbody = document.getElementById('addItemsBody');
        const idx = tbody.children.length + 1;
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td style="padding:6px;">${idx}</td>
            <td style="padding:6px;"><input class="row-desc" style="width:100%; padding:6px;"/></td>
            <td style="padding:6px;"><input type="number" class="row-qty" value="1" min="1" style="width:80px; padding:6px;"/></td>
            <td style="padding:6px;"><input type="number" class="row-price" value="0" step="0.01" style="width:120px; padding:6px;"/></td>
            <td style="padding:6px;" class="row-line">$0.00</td>
            <td style="padding:6px;"><button onclick="removeRow(this)">X</button></td>
        `;
        tbody.appendChild(tr);
        tr.querySelectorAll('.row-qty, .row-price').forEach(el => el.addEventListener('input', computeAddTotal));
    }

    function removeRow(btn) {
        const tr = btn.closest('tr');
        tr.remove();
        // reindex
        document.querySelectorAll('#addItemsBody tr').forEach((r, i) => r.children[0].textContent = i+1);
        computeAddTotal();
    }

    function computeAddTotal() {
        let total = 0;
        document.querySelectorAll('#addItemsBody tr').forEach(tr => {
            const qty = Number(tr.querySelector('.row-qty').value || 0);
            const price = Number(tr.querySelector('.row-price').value || 0);
            const line = qty * price;
            total += line;
            tr.querySelector('.row-line').textContent = `$${line.toFixed(2)}`;
        });
        document.getElementById('addTotal').textContent = `$${total.toFixed(2)}`;
    }

    async function saveNewOrder() {
        const customer = document.getElementById('addCustomer').value.trim();
        const orderDate = document.getElementById('addDate').value;
        const status = document.getElementById('addStatus').value;
        const items = [];
        document.querySelectorAll('#addItemsBody tr').forEach(tr => {
            const desc = tr.querySelector('.row-desc').value.trim();
            const qty = Number(tr.querySelector('.row-qty').value || 0);
            const price = Number(tr.querySelector('.row-price').value || 0);
            if (desc || qty > 0) {
                items.push({ description: desc, quantity: qty, unitPrice: price });
            }
        });

        if (!customer) { alert('Customer name is required'); return; }
        if (!items.length) { alert('Add at least one item'); return; }

        const payload = { customerName: customer, orderDate: orderDate, status: status, items: items };
        const res = await fetch('/api/orders', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + token },
            body: JSON.stringify(payload)
        });
        if (!res.ok) {
            const text = await res.text();
            alert('Failed to save order: ' + res.status + '\n' + text);
            return;
        }
        closeAddModal();
        // reload list and highlight new row by refreshing
        fetchOrders();
    }
</script>
</body>
</html>